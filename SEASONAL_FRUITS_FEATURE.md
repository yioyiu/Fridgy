# 🍎 当季水果卡片功能

## 功能概述

在app统计页面新增了一个智能当季水果卡片，利用AI技术显示当前季节的当季水果信息，包括营养价值、保存技巧等。

## 主要特性

### ✨ 智能AI驱动
- **智谱AI优先**：优先使用智谱AI获取当季水果信息
- **DeepSeek AI备用**：智谱AI不可用时自动切换到DeepSeek AI
- **本地数据兜底**：AI服务都不可用时使用本地数据库

### 🕐 自动定时更新
- **每天早上8点**：自动调用AI更新当季水果信息
- **智能缓存**：避免频繁调用AI，节省成本
- **手动刷新**：用户可随时手动刷新获取最新信息

### 🎨 美观的UI设计
- **季节主题**：根据当前季节显示不同的颜色和图标
- **卡片式布局**：水平滚动展示多种当季水果
- **详细信息**：每种水果显示营养价值、保存技巧等

## 技术实现

### 文件结构
```
src/
├── services/ai/
│   └── seasonalFruits.ts          # 当季水果AI服务
├── services/notifications/
│   └── seasonalFruitsScheduler.ts # 定时任务调度器
├── components/ai/
│   └── SeasonalFruitsCard.tsx     # 当季水果卡片组件
└── app/(tabs)/statistics/
    └── index.tsx                  # 统计页面（已集成卡片）
```

### 核心服务

#### 1. SeasonalFruitsService
- 支持多AI平台调用
- 智能降级机制
- 本地数据备份

#### 2. SeasonalFruitsScheduler
- 定时任务管理
- 数据缓存策略
- 自动更新逻辑

#### 3. SeasonalFruitsCard
- 响应式UI组件
- 季节主题适配
- 用户交互优化

## 使用方法

### 自动使用
卡片会在统计页面自动显示，无需额外配置。

### 手动刷新
点击卡片右上角的刷新按钮即可手动更新数据。

### 数据来源
- 智谱AI（优先级1）
- DeepSeek AI（优先级2）
- 本地数据（兜底方案）

## 配置要求

### 环境变量
确保在`.env`文件中配置了AI API密钥：
```env
EXPO_PUBLIC_ZHIPU_API_KEY=你的智谱AI密钥
EXPO_PUBLIC_DEEPSEEK_API_KEY=你的DeepSeek AI密钥
```

### 权限要求
- 本地通知权限（用于定时任务）
- 网络访问权限（用于AI API调用）

## 多语言支持

支持以下语言：
- 中文（zh）
- 英文（en）
- 西班牙语（es）
- 法语（fr）
- 德语（de）
- 日语（ja）
- 韩语（ko）

## 性能优化

### 缓存策略
- 数据缓存24小时
- 智能更新检测
- 减少不必要的API调用

### 用户体验
- 加载状态提示
- 错误处理机制
- 离线数据支持

## 未来扩展

### 计划功能
- 更多AI平台支持
- 水果营养成分分析
- 个性化推荐算法
- 用户偏好学习

### 技术改进
- 更智能的缓存策略
- 更丰富的本地数据
- 更美观的UI设计

## 故障排除

### 常见问题
1. **卡片不显示**：检查AI API密钥配置
2. **数据不更新**：检查网络连接和通知权限
3. **显示错误**：尝试手动刷新或重启应用

### 调试信息
开发模式下控制台会显示详细的调用过程和错误信息。

## 总结

当季水果卡片功能为Fridgy应用增加了智能化的季节性内容，通过AI技术为用户提供有价值的营养信息，同时通过定时任务和缓存机制确保良好的性能和用户体验。
