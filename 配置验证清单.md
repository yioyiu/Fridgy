# ✅ 配置验证清单

在开始构建之前，请确认以下配置都已正确完成：

---

## 📋 检查清单

### ✅ 步骤 1：ExportOptions.plist 配置

- [ ] 打开 `ios/ExportOptions.plist` 文件
- [ ] 确认 `YOUR_TEAM_ID` 已被替换为你的实际 Team ID
- [ ] Team ID 格式正确（例如：`ABC123DEFG`）

**如果还没有填写：**
1. 访问 https://developer.apple.com/account
2. 登录后，点击右上角账号名称
3. 复制 Team ID
4. 替换 `ios/ExportOptions.plist` 中的 `YOUR_TEAM_ID`

### ✅ 步骤 2：GitHub Secrets 配置

访问：`https://github.com/yioyiu/Fridgy/settings/secrets/actions`

确认以下 5 个 Secrets 都已配置：

- [ ] `APPLE_ID` - 你的 Apple ID 邮箱
- [ ] `APPLE_APP_SPECIFIC_PASSWORD` - App 专用密码
- [ ] `APPSTORE_ISSUER_ID` - Issuer ID（格式：12345678-1234-1234-1234-123456789012）
- [ ] `APPSTORE_API_KEY_ID` - Key ID（格式：ABC123DEFG）
- [ ] `APPSTORE_API_PRIVATE_KEY` - .p8 文件完整内容（包括 BEGIN 和 END 行）

### ✅ 步骤 3：文件提交

- [ ] `ios/ExportOptions.plist` 已提交到 Git
- [ ] `.github/workflows/ios-build-native.yml` 已提交到 Git

---

## 🚀 开始测试构建

确认所有配置都完成后，可以开始测试构建：

### 方式 1：手动触发（推荐首次测试）

1. 访问：https://github.com/yioyiu/Fridgy/actions
2. 左侧选择 **iOS Build (Native Xcode)**
3. 点击 **Run workflow** 按钮
4. 选择分支：`master`
5. 选择构建类型：`production`
6. 点击 **Run workflow**

### 方式 2：推送代码触发

```bash
# 确保 ExportOptions.plist 已更新并提交
git add ios/ExportOptions.plist
git commit -m "feat: 完成 GitHub Actions 配置"
git push origin master
```

---

## ⏱️ 构建时间

- **预计时间**：20-30 分钟
- **安装依赖**：2-3 分钟
- **构建应用**：15-20 分钟
- **上传到 App Store Connect**：2-5 分钟

---

## 📊 构建过程监控

构建开始后，你可以：

1. **查看实时日志**
   - 在 GitHub Actions 页面点击构建任务
   - 查看每个步骤的执行情况

2. **检查关键步骤**
   - ✅ Prebuild iOS project - 生成原生项目
   - ✅ Install CocoaPods dependencies - 安装依赖
   - ✅ Bump iOS build number - 递增构建号（39 → 40）
   - ✅ Build Archive - 构建应用
   - ✅ Export IPA - 导出 IPA 文件
   - ✅ Upload to App Store Connect - 上传到 App Store

---

## ✅ 构建成功标志

构建成功后，你应该看到：

1. **GitHub Actions**
   - ✅ 所有步骤显示绿色成功
   - ✅ 构建摘要显示成功信息
   - ✅ 可以下载 IPA 文件

2. **App Store Connect**
   - 访问 https://appstoreconnect.apple.com
   - 进入你的应用 → **TestFlight** 标签页
   - 应该能看到新的构建版本（Build 40）

---

## 🆘 如果构建失败

### 常见错误及解决方案

1. **ExportOptions.plist 中 Team ID 未配置**
   - 错误信息：`Please replace YOUR_TEAM_ID`
   - 解决：更新 `ios/ExportOptions.plist` 文件

2. **GitHub Secrets 配置错误**
   - 错误信息：`Authentication failed`
   - 解决：检查所有 5 个 Secrets 是否正确配置

3. **API Key 未激活**
   - 错误信息：`Invalid API Key`
   - 解决：等待几分钟后重试，或重新创建 API Key

4. **构建号递增失败**
   - 这是警告，不影响构建
   - 构建会使用当前的构建号（39）

---

## 🎯 下一步

构建成功后：

1. **在 App Store Connect 中提交审核**
   - 访问 App Store Connect
   - 进入你的应用
   - 创建新版本或更新现有版本
   - 提交审核

2. **监控构建状态**
   - 查看 GitHub Actions 构建历史
   - 监控 App Store Connect 中的构建状态

3. **（可选）禁用旧的 EAS Build workflow**
   - 如果新构建稳定，可以禁用旧的 workflow

---

**准备好了吗？** 确认所有配置都完成后，开始你的第一次构建吧！🚀

